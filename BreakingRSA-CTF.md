# Breaking RSA CTF Çözümü

## 1.Adım Ping Taraması
Makineye erişim olup olmadığını kontrol etmek için `ping` komutunu kullanıyoruz:

```bash
ping Machine_IP
```

## 2.Adım Nmap Taraması
Ardından, açık portları ve servisleri belirlemek için bir Nmap taraması gerçekleştirdim:
```bash
nmap --top-ports 100 -sV Machine_IP
```
Nmap Sonucu
```bash
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-02 12:21 EDT
Nmap scan report for Machine_IP
Host is up (0.070s latency).
Not shown: 98 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.46 seconds

```
## 3.Adım Dizin Taraması
```bash
gobuster dir -u Machine_IP -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
```
Gobuster Sonucu 
```bash
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     Machine_IP
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/development          (Status: 301) [Size: 178] [--> http://Machine_IP/development/]
/index.html           (Status: 200) [Size: 384]
Progress: 4734 / 4735 (99.98%)
```
## 4.Adım RSA Key Uzunluğunu Bulma
/development dizininde bulunan id_rsa.pub'un uzunluğunun kaç bit olduğuna bakıyoruz.
```bash
ssh-keygen -lf id_rsa.pub
```
Sonuç 
```bash
4096 SHA256:DIqTDIhboydTh2QU6i58JP+5aDRnLBPT8GwVun1n0Co no comment (RSA)
```
## 5.Adım N (Modulus) Bulma
```bash
ssh-keygen -e -f id_rsa.pub -m PEM | openssl rsa -pubin -noout -modulus
```
Çıktı
```bash
Modulus=EB661F287BC43C8FA92DDBA219F74EA467B5F2277B05095733B351AA7BCC3B66053E5C62F6BE9483D74D1A9DD3D03300E2DF0317F7C12F1146D3B5CA0CE29F3ADC2DE1DB78943A9999DCCC3CCF9D5BF431178CF2EE9CF9F0018C6123174FEDCCCA95F81409EDA7E3D407B93AAD184FC6B3E6AF8CF70FAD973756B180BA114CE0FF9EE0209B77D37332D057ACEE47A1257A3C4C3B35247BB160DC010E3B71DDBCED4F21F6121FF4F6A3EA15C9F28B5EAECD029207DBB86F7D49557292856431F8915C8A6EF88AFC16ED75D3736DFDCBF99C95F987F2A9750F225D5A29990345CCD1498D4D837BD96884B95466933CD5F3F5703C30185DD7E76173819ED8EBB25EE7A473FDF73C24C86AA91F8DE4FE48C817122657F20921937C37FE0CD8A2A1119C3C52301FEF1C22FF5751EF5014AA3DB5523C12513A53CD2C5F1518BD283908F72080A272EBC0C44F64D2C4EFC019CCF106349FB7F04743EBF071B1AD1275A0BD9AB2678F6EB0C01F833D2DEAA169E20D612850AEB5D30CBCFA076F5C46C3D6F51616CB130EA3F6CEE532BA1B691BB9791880708AC9B6FFB986A5FAAFA968397A5DD08A75847FD89257B67C57E251F35609C15FADED80210D69C7DA4BD2D83CC75347779E5E74074D63799B93723AEA7B610396B416B2AB9C48035CB54B24A3C450CC18F098403A2CDD382A5BDACC0FC2FA733B7D8E8E336EB3BB4A4917BCEF
```
## 6.Adım N Değerini Desimale Çevirme
Hex -> Desimal
```bash
echo $((16#HEX_DEĞERİ))
```
Çıktı
```bash
960343778775549488806716229688022562692463185460664314559819511657255292180827209174624059690060629715513180527734160798185034958883650709727032190772084959116259664047922715427522089353727952666824433207585440395813418471678775572995422248008108462980790558476993362919639516120538362516927622315187274971734081435230079153205750751020642956757117030852053008146976560531583447003355135460359928857010196241497604249151374353653491684214813678136396641706949128453526566651123162138806898116027920918258136713427376775618725136451984896300788465604914741872970173868541940675400325006679662030787570986695243903017923121105483935334289783830664260722704673471688470355268898058414366742781725580377180144541978809005281731232604162936015554289274471523038666760994260315829982230640668811250447030003462317740603204577123985618718687833015332554488836087898084147236609893032121172292368637672349405254772581742883431648376052937332995630141793928654990078967475194724151821689117026010445305375748604757116271353498403318409547515058838447618537811182917198454172161072247021099572638700461507432831248944781465511414308770376182766366160748136532693805002316728842876519091399408672222673058844554058431161474308624683491225222383
```
## 7.Adım p ve q Değerlerini Bulma
Aşağıdaki kod'da n değerini ekleyip çalıştırınca bize p ve q değerlerini veriyor.
```bash
from gmpy2 import isqrt
from math import lcm

def factorize(n):
    # since even nos. are always divisible by 2, one of the factors will
    # always be 2
    if (n & 1) == 0:
        return (n/2, 2)

    # isqrt returns the integer square root of n
    a = isqrt(n)

    # if n is a perfect square the factors will be ( sqrt(n), sqrt(n) )
    if a * a == n:
        return a, a

    while True:
        a = a + 1
        bsq = a * a - n
        b = isqrt(bsq)
        if b * b == bsq:
            break

    return a + b, a - b

print(factorize(N))
```
p ve q değerleri :
```bash
(mpz(30989413979221186440875537962143588279079180657276785773483163084840787431751925008409382782024837335054414229548213487269055726656919580388980384353939415484564294377142773553463724248812140196477077493185374579859773369113593661078143295090153526634169495633688691753691720088511452131593712380121967802013042678209312444897975134224456911144218687330712554564836016616829044029963400114373142702236623994027926718855592051277298418373056707389464234977873660836337340136755093657804153998347162906059312569124331219753644648657722107663012261197728061352359157767204739644300066112274629356310784052940617408518123),

mpz(30989413979221186440875537962143588279079180657276785773483163084840787431751925008409382782024837335054414229548213487269055726656919580388980384353939415484564294377142773553463724248812140196477077493185374579859773369113593661078143295090153526634169495633688691753691720088511452131593712380121967802013042678209312444897975134224456911144218687330712554564836016616829044029963400114373142702236623994027926718855592051277298418373056707389464234977873660836337340136755093657804153998347162906059312569124331219753644648657722107663012261197728061352359157767204739644300066112274629356310784052940617408516621))
```
## 8.Adım Private Key Oluşturma
Private key'i oluşturmak için aşağıdaki kodu kullanıyoruz : 
```bash
from Crypto.PublicKey import RSA
from Crypto.Util.number import long_to_bytes, bytes_to_long

# Değerler
n=960343778775549488806716229688022562692463185460664314559819511657255292180827209174624059690060629715513180527734160798185034958883650709727032190772084959116259664047922715427522089353727952666824433207585440395813418471678775572995422248008108462980790558476993362919639516120538362516927622315187274971734081435230079153205750751020642956757117030852053008146976560531583447003355135460359928857010196241497604249151374353653491684214813678136396641706949128453526566651123162138806898116027920918258136713427376775618725136451984896300788465604914741872970173868541940675400325006679662030787570986695243903017923121105483935334289783830664260722704673471688470355268898058414366742781725580377180144541978809005281731232604162936015554289274471523038666760994260315829982230640668811250447030003462317740603204577123985618718687833015332554488836087898084147236609893032121172292368637672349405254772581742883431648376052937332995630141793928654990078967475194724151821689117026010445305375748604757116271353498403318409547515058838447618537811182917198454172161072247021099572638700461507432831248944781465511414308770376182766366160748136532693805002316728842876519091399408672222673058844554058431161474308624683491225222383
p=30989413979221186440875537962143588279079180657276785773483163084840787431751925008409382782024837335054414229548213487269055726656919580388980384353939415484564294377142773553463724248812140196477077493185374579859773369113593661078143295090153526634169495633688691753691720088511452131593712380121967802013042678209312444897975134224456911144218687330712554564836016616829044029963400114373142702236623994027926718855592051277298418373056707389464234977873660836337340136755093657804153998347162906059312569124331219753644648657722107663012261197728061352359157767204739644300066112274629356310784052940617408518123
q=30989413979221186440875537962143588279079180657276785773483163084840787431751925008409382782024837335054414229548213487269055726656919580388980384353939415484564294377142773553463724248812140196477077493185374579859773369113593661078143295090153526634169495633688691753691720088511452131593712380121967802013042678209312444897975134224456911144218687330712554564836016616829044029963400114373142702236623994027926718855592051277298418373056707389464234977873660836337340136755093657804153998347162906059312569124331219753644648657722107663012261197728061352359157767204739644300066112274629356310784052940617408516621
e = 65537
d=355800651425135681183390707128108943722411746130741264046675581161020732554780741656912077045552316250703809090954928640931547581315194819458963160110120922414848114847301699090523885005384262610482079782617179276603225871047383152843460146236246419421648466520894698339133117031948242676251882103774390399143617061031502081556812701001453097227818768422703191949841125871910183204731160170789011284878230235436521793393724471383499879219675769700014447675151926209318073223612943831612223524959548771170877787184798441930486061891613062347672989812669710963541034708669406007894705151093105784054091751650933323300985495149924416659229876914076648270045676997650015615996341370380597228469755128170040353433374999020283706184957220148628008445610267702031710365117500478110172685332610159706254466309767816421842113204954137883347698932245158527034600826313156623260808181115243968071291416762806090766691780165333622281350406073396430046330125424011836635616883856583961232702990430895725627105993091471281133235092845210740773088363495356096518772606314489088890124113092286827052036690187298835257796804255669912241916692428526192173280096699373626286648150269450291733933394106397510904039580604434322844051351031280613818868793

# Anahtar Oluşturma
key = RSA.construct((n, e, d, p, q))
private_key_pem = key.export_key()

with open("private_key.pem", "wb") as f:
    f.write(private_key_pem)

```
Key oluşturduktan sonra izinleri değiştiriyoruz.
```bash
chmod 600 private_key_pem
```
## 9.Adımm SSH'le Sunucuya Bağlanma
```bash
ssh -i private_key.pem root@Machine_IP
```
Sunucuya bağlandıktan sonra flagi buluyoruz: 
```bash
Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-124-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon 02 Sep 2024 04:51:43 PM UTC

  System load:  0.0               Processes:             108
  Usage of /:   70.1% of 4.84GB   Users logged in:       0
  Memory usage: 45%               IPv4 address for eth0: Machine_IP
  Swap usage:   0%


0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Sat Aug 13 09:35:51 2022 from 10.0.0.11
root@thm:~# ls
flag  snap
root@thm:~# cat flag
```
```bash
breakingRSAissuperfun20220809134031
```


